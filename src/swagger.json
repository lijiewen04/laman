{
  "openapi": "3.0.1",
  "info": {
    "title": "个人项目",
    "description": "",
    "version": "1.0.0"
  },
  "tags": [
    {
      "name": "Auth"
    },
    {
      "name": "Patient"
    },
    {
      "name": "File"
    },
    {
      "name": "System"
    }
  ],
  "paths": {
    "/api/auth/register": {
      "post": {
        "summary": "用户注册",
        "deprecated": false,
        "description": "",
        "tags": ["Auth", "Auth"],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RegisterRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "标准响应",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthRegisterResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": []
      }
    },
    "/api/auth/login": {
      "post": {
        "summary": "用户登录",
        "deprecated": false,
        "description": "",
        "tags": ["Auth", "Auth"],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              },
              "examples": {}
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "登录结果（返回 token）",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/AuthLoginResponse" }
              }
            },
            "headers": {}
          },
          "x-200-2": {
            "description": "备用响应",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/AuthLoginResponse" } } },
            "headers": {}
          }
        },
        "security": []
      }
    },
    "/api/auth/me": {
      "post": {
        "summary": "获取当前用户信息",
        "deprecated": false,
        "description": "",
        "tags": ["Auth", "Auth"],
        "parameters": [],
        "responses": {
          "200": {
            "description": "当前用户信息",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthMeResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/api/auth/user-list": {
      "post": {
        "summary": "获取用户列表（管理员/超级管理员）",
        "deprecated": false,
        "description": "",
        "tags": ["Auth", "Auth"],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/AuthUserListQuery" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "用户列表",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthUserListResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/api/auth/profile": {
      "post": {
        "summary": "更新当前用户资料",
        "deprecated": false,
        "description": "",
        "tags": ["Auth", "Auth"],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateProfileRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "更新结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthProfileResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/api/auth/update-permission": {
      "post": {
        "summary": "更新指定用户权限（超级管理员）",
        "deprecated": false,
        "description": "",
        "tags": ["Auth", "Auth"],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdatePermissionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "更新权限结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthUpdatePermissionResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/api/auth/delete": {
      "post": {
        "summary": "删除用户（超级管理员）",
        "deprecated": false,
        "description": "",
        "tags": ["Auth", "Auth"],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DeleteUserRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "删除结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthDeleteUserResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/api/patient/create": {
      "post": {
        "summary": "创建病人（管理员/超级管理员）",
        "deprecated": false,
        "description": "",
        "tags": ["Patient", "Patient"],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PatientCreate"
              },
              "examples": {}
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "创建结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PatientCreateResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/api/patient/list": {
      "post": {
        "summary": "获取病人列表",
        "deprecated": false,
        "description": "",
        "tags": ["Patient", "Patient"],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PatientListQuery"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "病人列表",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PatientListResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/api/patient/detail": {
      "post": {
        "summary": "获取病人详情",
        "deprecated": false,
        "description": "",
        "tags": ["Patient", "Patient"],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/GetDetailRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "病人详情",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PatientDetailResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/api/patient/update": {
      "post": {
        "summary": "更新病人信息（管理员/超级管理员）",
        "deprecated": false,
        "description": "",
        "tags": ["Patient", "Patient"],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdatePatientRequest"
              },
              "examples": {}
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "更新结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PatientUpdateResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/api/patient/delete": {
      "post": {
        "summary": "删除病人（超级管理员）",
        "deprecated": false,
        "description": "",
        "tags": ["Patient", "Patient"],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DeletePatientRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "删除结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PatientDeleteResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/api/patient/groups": {
      "post": {
        "summary": "获取分组列表",
        "deprecated": false,
        "description": "",
        "tags": ["Patient", "Patient"],
        "parameters": [],
        "responses": {
          "200": {
            "description": "分组列表",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PatientGroupsResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/api/patient/statistics": {
      "post": {
        "summary": "获取统计数据",
        "deprecated": false,
        "description": "",
        "tags": ["Patient", "Patient"],
        "parameters": [],
        "responses": {
          "200": {
            "description": "统计数据",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PatientStatisticsResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/api/file/upload": {
      "post": {
        "summary": "文件上传（管理员/超级管理员）",
        "deprecated": false,
        "description": "",
        "tags": ["File", "File"],
        "parameters": [],
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "example": ""
                  },
                  "fileType": {
                    "type": "string",
                    "example": ""
                  },
                  "description": {
                    "type": "string",
                    "example": ""
                  }
                },
                "required": ["file"]
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "上传结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FileUploadResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/api/file/download": {
      "post": {
        "summary": "文件下载（管理员/超级管理员/用户）",
        "deprecated": false,
        "description": "使用 POST 请求，传入 { id }，并在 `Authorization` 头中携带 `Bearer <token>`。",
        "tags": ["File", "File"],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DownloadRequest"
              },
              "examples": {}
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "二进制文件流（成功）",
            "content": {
              "application/octet-stream": {
                "schema": { "$ref": "#/components/schemas/FileDownloadSuccess" }
              }
            },
            "headers": {}
          },
          "x-200-2": {
            "description": "失败返回 JSON",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/FileDownloadError" } } },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/api/file/list": {
      "post": {
        "summary": "获取文件列表",
        "deprecated": false,
        "description": "",
        "tags": ["File", "File"],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/FileListQuery"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "文件列表和分页信息",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FileListResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/api/file/preview": {
      "post": {
        "summary": "获取文件预览",
        "deprecated": false,
        "description": "",
        "tags": ["File", "File"],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/FilePreviewRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "预览数据（JSON）",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FilePreviewResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/api/file/types": {
      "post": {
        "summary": "获取文件类型列表",
        "deprecated": false,
        "description": "",
        "tags": ["File", "File"],
        "parameters": [],
        "responses": {
          "200": {
            "description": "文件类型列表",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FileTypesResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/api/file/delete": {
      "post": {
        "summary": "删除文件（超级管理员）",
        "deprecated": false,
        "description": "",
        "tags": ["File", "File"],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DeleteFileRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "删除结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FileDeleteResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/api/file/authorize-download": {
      "post": {
        "summary": "授权访客下载（超级管理员）",
        "deprecated": false,
        "description": "",
        "tags": ["File", "File"],
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AuthorizeDownloadRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "授权结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthorizeDownloadResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": [{ "bearerAuth": [] }]
      }
    },
    "/health": {
      "post": {
        "summary": "健康检查",
        "deprecated": false,
        "description": "",
        "tags": ["System", "System"],
        "parameters": [],
        "responses": {
          "200": {
            "description": "服务状态",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            },
            "headers": {}
          }
        },
        "security": []
      }
    }
  },
  "components": {
    "schemas": {
      "BaseResponse": {
        "type": "object",
        "properties": {
          "status": { "type": "integer", "example": 0 },
          "msg": { "type": "string", "example": "成功" }
        }
      },
      "UserPermission": {
        "type": "string",
        "enum": ["访客", "用户", "管理员", "超级管理员"],
        "description": "用户权限类型枚举"
      },
      "AuthRegisterResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          {
            "properties": {
              "data": {
                "type": "object",
                "properties": {
                  "token": { "type": "string" },
                  "user": {
                    "type": "object",
                    "properties": {
                      "id": { "type": "integer" },
                      "username": { "type": "string" },
                      "userPermission": { "$ref": "#/components/schemas/UserPermission" }
                    }
                  }
                }
              }
            }
          }
        ]
      },
      "AuthLoginResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          {
            "properties": {
              "data": { "type": "string", "description": "JWT token" }
            }
          }
        ]
      },
      "AuthMeResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          {
            "properties": {
              "data": {
                "type": "object",
                "properties": {
                  "id": { "type": "integer" },
                  "username": { "type": "string" },
                  "userPermission": { "$ref": "#/components/schemas/UserPermission" },
                  "department": { "type": "string" },
                  "phone": { "type": "string" }
                }
              }
            }
          }
        ]
      },
      "AuthUserListResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          {
            "properties": {
              "data": {
                "type": "object",
                "properties": {
                  "items": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "id": { "type": "integer" },
                        "username": { "type": "string" },
                        "userPermission": { "$ref": "#/components/schemas/UserPermission" },
                        "department": { "type": "string" },
                        "phone": { "type": "string" }
                      }
                    }
                  },
                  "pagination": {
                    "type": "object",
                    "properties": {
                      "page": { "type": "integer" },
                      "limit": { "type": "integer" },
                      "total": { "type": "integer" },
                      "totalPages": { "type": "integer" }
                    }
                  }
                }
              }
            }
          }
        ]
      },
      "AuthProfileResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          {
            "properties": {
              "data": {
                "type": "object",
                "nullable": true,
                "properties": {
                  "username": { "type": "string" },
                  "userPermission": { "$ref": "#/components/schemas/UserPermission" },
                  "department": { "type": "string" },
                  "phone": { "type": "string" }
                }
              }
            }
          }
        ]
      },
      "AuthUpdatePermissionResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          {
            "properties": {
              "data": {
                "type": "object",
                "nullable": true,
                "properties": {
                  "id": { "type": "integer" },
                  "username": { "type": "string" },
                  "userPermission": { "$ref": "#/components/schemas/UserPermission" }
                }
              }
            }
          }
        ]
      },
      "AuthDeleteUserResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          { "properties": { "data": { "nullable": true, "type": "object" } } }
        ]
      },
      "LoginRequest": {
        "type": "object",
        "properties": {
          "username": {
            "type": "string"
          },
          "password": {
            "type": "string"
          }
        },
        "required": ["username", "password"]
      },
      "RegisterRequest": {
        "type": "object",
        "properties": {
          "username": {
            "type": "string"
          },
          "password": {
            "type": "string"
          },
          "department": {
            "type": "string",
            "default": "访客",
            "description": "注册时默认部门为 访客，可由用户提交修改"
          },
          "phone": {
            "type": "string"
          }
        },
        "required": ["username", "password"]
      },
      "PatientCreateResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          { "properties": { "data": { "$ref": "#/components/schemas/PatientListItem" } } }
        ]
      },
      "PatientListResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          {
            "properties": {
              "data": {
                "type": "object",
                "properties": {
                  "items": { "type": "array", "items": { "$ref": "#/components/schemas/PatientListItem" } },
                  "pagination": {
                    "type": "object",
                    "properties": {
                      "page": { "type": "integer" },
                      "limit": { "type": "integer" },
                      "total": { "type": "integer" },
                      "totalPages": { "type": "integer" }
                    }
                  }
                }
              }
            }
          }
        ]
      },
      "PatientDetailResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          { "properties": { "data": { "$ref": "#/components/schemas/PatientListItem" } } }
        ]
      },
      "PatientUpdateResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          { "properties": { "data": { "type": "object", "nullable": true } } }
        ]
      },
      "PatientDeleteResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          { "properties": { "data": { "nullable": true, "type": "object" } } }
        ]
      },
      "PatientGroupsResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          {
            "properties": {
              "data": {
                "type": "object",
                "properties": {
                  "items": { "type": "array", "items": { "type": "string" } },
                  "pagination": {
                    "type": "object",
                    "properties": {
                      "page": { "type": "integer" },
                      "limit": { "type": "integer" },
                      "total": { "type": "integer" },
                      "totalPages": { "type": "integer" }
                    }
                  }
                }
              }
            }
          }
        ]
      },
      "PatientStatisticsResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          {
            "properties": {
              "data": {
                "type": "object",
                "properties": {
                  "total": { "type": "integer" },
                  "tested": { "type": "integer" },
                  "inpatient": { "type": "integer" },
                  "outpatient": { "type": "integer" }
                }
              }
            }
          }
        ]
      },
      "FileInfo": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "filename": { "type": "string" },
          "originalName": { "type": "string" },
          "mimeType": { "type": "string" },
          "size": { "type": "integer" },
          "fileType": { "type": "string" },
          "description": { "type": "string" },
          "metadata": {
            "oneOf": [{ "type": "object", "additionalProperties": true }, { "type": "string" }],
            "description": "文件元数据，可能为对象或 JSON 字符串"
          },
          "downloadCount": { "type": "integer" },
          "createdAt": { "type": "string", "format": "date-time" },
          "uploadedBy": { "type": "integer" },
          "uploadedByUsername": { "type": "string" },
          "importedTable": { "type": "string" }
        }
      },
      "FileUploadResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          { "properties": { "data": { "$ref": "#/components/schemas/FileInfo" } } }
        ]
      },
      "FileDownloadSuccess": {
        "type": "string",
        "format": "binary",
        "description": "Binary file stream"
      },
      "FileDownloadError": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          { "properties": { "data": { "type": "object", "nullable": true } } }
        ]
      },
      "FileListResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          {
            "properties": {
              "data": {
                "type": "object",
                "properties": {
                  "files": {
                    "type": "array",
                    "items": { "$ref": "#/components/schemas/FileInfo" }
                  },
                  "pagination": {
                    "type": "object",
                    "properties": {
                      "page": { "type": "integer" },
                      "limit": { "type": "integer" },
                      "total": { "type": "integer" },
                      "totalPages": { "type": "integer" }
                    }
                  }
                }
              }
            }
          }
        ]
      },
      "FilePreviewResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          {
            "properties": {
              "data": {
                "type": "object",
                "properties": {
                  "preview": {
                    "type": "array",
                    "nullable": true,
                    "items": { "type": "object", "additionalProperties": true }
                  },
                  "totalRows": { "type": "integer" },
                  "fileType": { "type": "string" },
                  "source": { "type": "string" },
                  "sheetName": { "type": "string" },
                  "totalSheets": { "type": "integer" },
                  "message": { "type": "string" }
                }
              }
            }
          }
        ]
      },
      "FileTypesResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          {
            "properties": {
              "data": {
                "type": "object",
                "properties": {
                  "items": { "type": "array", "items": { "type": "string" } },
                  "pagination": {
                    "type": "object",
                    "properties": {
                      "page": { "type": "integer" },
                      "limit": { "type": "integer" },
                      "total": { "type": "integer" },
                      "totalPages": { "type": "integer" }
                    }
                  }
                }
              }
            }
          }
        ]
      },
      "FileDeleteResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          { "properties": { "data": { "type": "object", "nullable": true } } }
        ]
      },
      "AuthorizeDownloadResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          {
            "properties": {
              "data": {
                "type": "object",
                "properties": {
                  "username": { "type": "string" },
                  "fileId": { "type": "integer" },
                  "expiresAt": { "type": "string", "format": "date-time" }
                }
              }
            }
          }
        ]
      },
      "HealthResponse": {
        "type": "object",
        "allOf": [
          { "$ref": "#/components/schemas/BaseResponse" },
          {
            "properties": {
              "data": { "type": "object", "properties": { "timestamp": { "type": "string", "format": "date-time" } } }
            }
          }
        ]
      },
      "UpdateProfileRequest": {
        "type": "object",
        "properties": {
          "username": {
            "type": "string"
          },
          "department": {
            "type": "string"
          },
          "phone": {
            "type": "string"
          }
        }
      },
      "UpdatePermissionRequest": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "用户 ID（用于标识要修改权限的用户）"
          },
          "userPermission": { "$ref": "#/components/schemas/UserPermission" }
        },
        "required": ["id", "userPermission"]
      },
      "DeleteUserRequest": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "要删除的用户 ID"
          }
        },
        "required": ["id"]
      },
      "PatientCreate": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "serialNo": {
            "type": "string"
          },
          "abbr": {
            "type": "string"
          },
          "time": {
            "type": "integer"
          },
          "inpatientOutpatient": {
            "type": "string",
            "enum": ["住院", "门诊"]
          },
          "group": {
            "type": "string"
          },
          "gender": {
            "type": "string"
          },
          "age": {
            "type": "integer"
          },
          "caseNo": {
            "type": "string"
          },
          "diagnosis": {
            "type": "string"
          },
          "isTested": {
            "type": "boolean"
          },
          "preTreatment": {
            "type": "boolean"
          },
          "treatmentType": {
            "type": "string"
          },
          "memo": {
            "type": "string"
          }
        },
        "required": ["name", "serialNo"]
      },
      "PatientListQuery": {
        "type": "object",
        "properties": {
          "page": {
            "type": "integer",
            "default": 1
          },
          "limit": {
            "type": "integer",
            "default": 20
          },
          "name": {
            "type": "string"
          },
          "serialNo": {
            "type": "string"
          },
          "inpatientOutpatient": {
            "type": "string"
          },
          "isTested": {
            "type": "boolean"
          },
          "diagnosis": {
            "type": "string"
          },
          "group": {
            "type": "string"
          },
          "abbr": { "type": "string" },
          "gender": { "type": "string", "description": "男/女/未知/其他" },
          "ageMin": { "type": "integer", "description": "年龄下限（包含）" },
          "ageMax": { "type": "integer", "description": "年龄上限（包含）" },
          "caseNo": { "type": "string" },
          "tStage": { "type": "string" },
          "nStage": { "type": "string" },
          "mStage": { "type": "string" },
          "stage": { "type": "string" },
          "preTreatment": { "type": "boolean" },
          "treatmentType": { "type": "string" },
          "memo": { "type": "string" },
          "createdBy": { "type": "integer", "description": "创建者用户ID" },
          "timeStart": { "type": "string", "description": "起始时间（ISO 或 与数据库一致的格式）" },
          "timeEnd": { "type": "string", "description": "结束时间（ISO 或 与数据库一致的格式）" }
        }
      },
      "AuthUserListQuery": {
        "type": "object",
        "properties": {
          "page": { "type": "integer", "default": 1 },
          "limit": { "type": "integer", "default": 20 },
          "username": { "type": "string", "description": "按用户名模糊搜索" },
          "department": { "type": "string", "description": "按科室/部门模糊搜索" },
          "userPermission": {
            "$ref": "#/components/schemas/UserPermission",
            "description": "按权限精确匹配（例如：超级管理员/管理员/访客）"
          }
          ,
          "phone": { "type": "string", "description": "按电话号码模糊搜索" },
          "createdAtStart": { "type": "string", "description": "创建时间起始（ISO）" },
          "createdAtEnd": { "type": "string", "description": "创建时间结束（ISO）" },
          "isActive": { "type": "boolean", "description": "是否只返回激活用户；未提供则默认为 true" }
        }
      },
      "PatientListItem": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "abbr": {
            "type": "string"
          },
          "time": {
            "type": "integer"
          },
          "name": {
            "type": "string"
          },
          "serialNo": {
            "type": "string"
          },
          "inpatientOutpatient": {
            "type": "string"
          },
          "group": {
            "type": "string"
          },
          "gender": {
            "type": "string"
          },
          "age": {
            "type": "integer"
          },
          "caseNo": {
            "type": "string"
          },
          "diagnosis": {
            "type": "string"
          },
          "isTested": {
            "type": "boolean"
          },
          "tStage": {
            "type": "string"
          },
          "nStage": {
            "type": "string"
          },
          "mStage": {
            "type": "string"
          },
          "stage": {
            "type": "string"
          },
          "preTreatment": {
            "type": "string"
          },
          "treatmentType": {
            "type": "string"
          },
          "memo": {
            "type": "string"
          }
        }
      },
      "GetDetailRequest": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          }
        },
        "required": ["id"]
      },
      "UpdatePatientRequest": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "name": {
            "type": "string"
          },
          "serialNo": {
            "type": "string"
          },
          "abbr": {
            "type": "string"
          },
          "time": {
            "type": "integer"
          },
          "inpatientOutpatient": {
            "type": "string",
            "enum": ["住院", "门诊"]
          },
          "group": {
            "type": "string"
          },
          "gender": {
            "type": "string"
          },
          "age": {
            "type": "integer"
          },
          "caseNo": {
            "type": "string"
          },
          "diagnosis": {
            "type": "string"
          },
          "isTested": {
            "type": "boolean"
          },
          "preTreatment": {
            "type": "boolean"
          },
          "treatmentType": {
            "type": "string"
          },
          "memo": {
            "type": "string"
          }
        },
        "required": ["id"]
      },
      "DeletePatientRequest": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          }
        },
        "required": ["id"]
      },
      "FileUpload": {
        "type": "object",
        "properties": {
          "file": {
            "type": "string",
            "format": "binary"
          },
          "fileType": {
            "type": "string"
          },
          "description": {
            "type": "string"
          }
        },
        "required": ["file"]
      },
      "DownloadRequest": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          }
        },
        "required": ["id"]
      },
      "FileListQuery": {
        "type": "object",
        "properties": {
          "page": {
            "type": "integer",
            "default": 1
          },
          "limit": {
            "type": "integer",
            "default": 20
          },
          "fileType": {
            "type": "string"
          },
          "uploadedBy": {
            "type": "string"
          },
          "uploadedById": { "type": "integer", "description": "按上传者用户ID过滤" },
          "mimeType": { "type": "string" },
          "minSize": { "type": "integer", "description": "最小文件大小（字节）" },
          "maxSize": { "type": "integer", "description": "最大文件大小（字节）" },
          "description": { "type": "string" },
          "createdAtStart": { "type": "string", "description": "创建时间起始（ISO）" },
          "createdAtEnd": { "type": "string", "description": "创建时间结束（ISO）" },
          "filename": {
            "type": "string"
          },
          "originalName": {
            "type": "string"
          }
        }
      },
      "FilePreviewRequest": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "limit": {
            "type": "integer",
            "default": 10
          }
        },
        "required": ["id"]
      },
      "DeleteFileRequest": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          }
        },
        "required": ["id"]
      },
      "AuthorizeDownloadRequest": {
        "type": "object",
        "properties": {
          "fileId": {
            "type": "integer"
          },
          "userId": {
            "type": "integer",
            "description": "目标用户的 ID（只接受 userId 以标识用户）"
          },
          "expiresIn": {
            "type": "integer",
            "description": "hours, default 24"
          }
        },
        "required": ["fileId", "userId"]
      }
    },
    "securitySchemes": {
      "bearerAuth": { "type": "http", "scheme": "bearer", "bearerFormat": "JWT" }
    }
  },
  "servers": []
}
